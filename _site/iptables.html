<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=7a92024cdf68470534dc7022800bf9aca2878458">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Show hit for rules with auto refresh | Welcome to Ireaneus Linux Cheat Sheets webpage</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Show hit for rules with auto refresh" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Linux command line cheat sheets website" />
<meta property="og:description" content="Linux command line cheat sheets website" />
<link rel="canonical" href="http://localhost:4000/iptables.html" />
<meta property="og:url" content="http://localhost:4000/iptables.html" />
<meta property="og:site_name" content="Welcome to Ireaneus Linux Cheat Sheets webpage" />
<script type="application/ld+json">
{"description":"Linux command line cheat sheets website","@type":"WebPage","headline":"Show hit for rules with auto refresh","url":"http://localhost:4000/iptables.html","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <header>
      <div class="container">
        <h1>Welcome to Ireaneus Linux Cheat Sheets webpage</h1>
        <h2>Linux command line cheat sheets website</h2>

        <section id="downloads">
          
          <a href="https://github.com/ireaneus/linux-cheat-sheets" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1 id="show-hit-for-rules-with-auto-refresh">Show hit for rules with auto refresh</h1>
<p>watch –interval 0 ‘iptables -nvL | grep -v “0     0”’</p>

<h1 id="show-hit-for-rule-with-auto-refresh-and-highlight-any-changes-since-the-last-refresh">Show hit for rule with auto refresh and highlight any changes since the last refresh</h1>
<p>watch -d -n 2 iptables -nvL</p>

<h1 id="block-the-port-902-and-we-hide-this-port-from-nmap">Block the port 902 and we hide this port from nmap.</h1>
<p>iptables -A INPUT -i eth0 -p tcp –dport 902 -j REJECT –reject-with icmp-port-unreachable</p>

<h1 id="note-reject-with-accept">Note, –reject-with accept:</h1>
<h1 id="icmp-net-unreachable">icmp-net-unreachable</h1>
<h1 id="icmp-host-unreachable">icmp-host-unreachable</h1>
<h1 id="icmp-port-unreachable---hide-a-port-to-nmap">icmp-port-unreachable &lt;- Hide a port to nmap</h1>
<h1 id="icmp-proto-unreachable">icmp-proto-unreachable</h1>
<h1 id="icmp-net-prohibited">icmp-net-prohibited</h1>
<h1 id="icmp-host-prohibited-or">icmp-host-prohibited or</h1>
<h1 id="icmp-admin-prohibited">icmp-admin-prohibited</h1>
<h1 id="tcp-reset">tcp-reset</h1>

<h1 id="add-a-comment-to-a-rule">Add a comment to a rule:</h1>
<p>iptables … -m comment –comment “This rule is here for this reason”</p>

<h1 id="to-remove-or-insert-a-rule">To remove or insert a rule:</h1>
<h1 id="1-show-all-rules">1) Show all rules</h1>
<p>iptables -L INPUT –line-numbers</p>
<h1 id="or-iptables--nl-line-numbers">OR iptables -nL –line-numbers</h1>

<h1 id="chain-input-policy-accept">Chain INPUT (policy ACCEPT)</h1>
<h1 id="num--target-prot-opt-source-destination">num  target prot opt source destination</h1>
<h1 id="1----accept-----udp----anywhere--anywhere-------------udp-dptdomain">1    ACCEPT     udp  –  anywhere  anywhere             udp dpt:domain</h1>
<h1 id="2----accept-----tcp----anywhere--anywhere-------------tcp-dptdomain">2    ACCEPT     tcp  –  anywhere  anywhere             tcp dpt:domain</h1>
<h1 id="3----accept-----udp----anywhere--anywhere-------------udp-dptbootps">3    ACCEPT     udp  –  anywhere  anywhere             udp dpt:bootps</h1>
<h1 id="4----accept-----tcp----anywhere--anywhere-------------tcp-dptbootps">4    ACCEPT     tcp  –  anywhere  anywhere             tcp dpt:bootps</h1>

<h1 id="2a-remove--d-a-rule-here-an-input-rule">2.a) REMOVE (-D) a rule. (here an INPUT rule)</h1>
<p>iptables -D INPUT 2</p>

<h1 id="2b-or-insert-a-rule">2.b) OR INSERT a rule.</h1>
<p>iptables -I INPUT {LINE_NUMBER} -i eth1 -p tcp –dport 21 -s 123.123.123.123 -j ACCEPT -m comment –comment “This rule is here for this reason”</p>

      </section>
    </div>

    
  </body>
</html>
